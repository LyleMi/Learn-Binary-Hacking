Windows
========================================

常见API
----------------------------------------

注册表
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
- RegCreateKeyExA
- RegCreateKeyExW
- RegSetValueExA
- RegSetValueExW
- RegCreateKeyA
- RegCreateKeyW
- RegDeleteKeyA
- RegDeleteKeyW
- RegCloseKey

进程
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
- CreateProcessA / CreateProcessW
- CreateProcessAsUserA / CreateProcessAsUserW
- CreateProcessInternalA / CreateProcessInternalW
- CreateProcessWithLogonW CreateProcessWithTokenW
- OpenProcess
- WriteProcessMemory
- ReadProcessMemory
- WinExec
- ShellExecuteA / ShellExecuteW
- ShellExecuteExA / ShellExecuteExW

线程
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
- CreateThread
- CreateRemoteThread
- CreateRemoteThreadEx

操作系统
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
- CreateToolhelp32Snapshot

文件
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
- CreateFileA
- CreateFileW
- OpenFile
- DeleteFileA
- DeleteFileW
- NtOpenFile
- NtCreateFile

Hook
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
- SetWindowsHookExA
- SetWindowsHookExW
- CallNextHookEx
- UnhookWindowsHookEx
- GetAsyncKeyState
- GetKeyState
- GetKeyboardState

网络
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
- socket
- send
- recv
- listen
- connect
- bind
- gethostbyname
- gethostbyaddr
- URLDownloadToFile
- HttpOpenRequestA
- HttpOpenRequestW
- HttpSendRequestA
- HttpSendRequestW
- InternetConnectA
- InternetConnectW
- InternetCrackUrlA
- InternetCrackUrlW
- InternetOpenA
- InternetOpenW
- InternetOpenUrlA
- InternetOpenUrlW

内存
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
- SecureZeroMemory
- memcpy
- wmemcpy
- memcpy
- wmemcpy
- VirtualProtect
- VirtualProtectEx
- VirtualAlloc
- VirtualAllocEx
- VirtualQuery
- VirtualQueryEx
- LoadLibraryA
- LoadLibraryW
- LoadLibraryExA
- LoadLibraryExW
- LoadModule
- LoadPackagedLibrary

其它
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
- NtRenameKey
- LookupPrivilegeValueA
- LookupPrivilegeValueW
- ExitWindowsEx

常见行为
----------------------------------------
- 进程创建
- 线程创建
- UAC

常见 Shellcode 执行技术
----------------------------------------
- 远程线程注入
- dll注入
- 资源加载
- ...

参考链接
----------------------------------------
- `免杀技术大杂烩 <https://github.com/Airboi/bypass-av-note>`_
- `ThreadStackSpoofer <https://github.com/mgeeky/ThreadStackSpoofer>`_
